# MultimediaProcessor 快速入门指南

## 5 分钟上手

### 第一步：准备配置文件

```bash
cd Plugin/MultimediaProcessor

# 复制配置文件
cp presets.json.example presets.json
cp path-aliases.json.example path-aliases.json
```

### 第二步：设置路径别名（可选但推荐）

编辑 `path-aliases.json`：

```json
{
  "images": "/Users/你的用户名/Pictures",
  "downloads": "/Users/你的用户名/Downloads"
}
```

### 第三步：立即使用

在系统提示词或用户消息中使用以下语法：

```
{{OverBase64::detailed::/path/to/your/image.jpg}}
```

## 三种主要用法

### 1. 单文件分析

```
分析这张图片：
{{OverBase64::detailed::images/photo.jpg}}
```

### 2. 文件夹批量处理

```
分析这个文件夹中的所有图片：
{{OverBase64::summary::images/project}}
```

### 3. 多预设组合

```
从技术和艺术角度分析：
{{OverBase64::technical;emotional::images/design.png}}
```

## 常用预设说明

| 预设名 | 用途 | 输出特点 | 温度 | 模型 |
|-------|------|---------|------|------|
| `detailed` | 详细描述 | 全面、细致 | 0.7 | 全局配置 |
| `summary` | 简要概括 | 精炼、一句话 | 0.5 | 全局配置 |
| `technical` | 技术分析 | 分辨率、质量等 | 0.3 | gpt-4-vision |
| `emotional` | 情感分析 | 氛围、情绪 | 0.8 | 全局配置 |
| `creative` | 创意描述 | 富有想象力 | 1.0 | claude-3-opus |
| `precise` | 精确分析 | 客观事实 | 0.1 | gpt-4-vision |
| `default` | 默认预设 | 通用描述 | 0.7 | 全局配置 |

## 自定义预设参数

编辑 `presets.json` 可以自定义以下参数：

```json
{
  "my_preset": {
    "displayName": "我的预设",
    "prompt": "你的提示词",
    "model": "gpt-4-vision-preview",  // 留空使用全局配置
    "maxTokens": 2000,
    "temperature": 0.7,  // 0.0-2.0，控制创意度
    "topP": 1.0,         // 0.0-1.0，控制采样
    "thinkingBudget": 0
  }
}
```

**温度参数快速指南：**
- `0.1-0.3`: 精确、一致（技术分析、数据提取）
- `0.5-0.7`: 平衡（通用场景）
- `0.8-1.0`: 创意、多样（文案创作）

## 缓存使用

第一次分析：
```
{{OverBase64::detailed::images/photo.jpg}}
```

后续使用缓存（快速、省钱）：
```
{{OverBase64::detailed::images/photo.jpg::cache}}
```

## 完整示例

### 示例 1：代码审查

**系统提示词：**
```
你是代码审查专家。请审查以下代码截图：
{{OverBase64::detailed::screenshots}}
```

### 示例 2：UI 设计评审

**用户消息：**
```
请评审这个设计稿的用户体验和技术实现：
{{OverBase64::emotional;technical::designs/homepage.png::cache}}
```

### 示例 3：批量图片说明

**用户消息：**
```
为这些产品图片生成商品描述：
{{OverBase64::detailed::products::cache}}
```

## 与 {{ShowBase64}} 的区别

- **{{ShowBase64}}**: 跳过所有处理，直接发送 Base64 给 AI
- **{{OverBase64::...}}**: 使用自定义预设处理后再发给 AI

可以同时使用：
```
{{ShowBase64}}
请直接分析这个图片：[图片的 Base64 数据]

同时，这里有预处理的参考：
{{OverBase64::summary::reference.jpg}}
```

## 文件过滤功能

### 白名单（支持的格式）

在 `config.env` 中配置：
```env
SupportedMediaFormats=.jpg,.jpeg,.png,.gif,.webp,.mp4,.mp3
```

### 黑名单（忽略文件）

在目标文件夹中创建 `.overbase64ignore`：
```
# 忽略临时文件
*.tmp
*_backup.*
*_draft.*
Thumbs.db
```

**过滤顺序**：白名单（格式检查）→ 黑名单（ignore 规则）→ 最终处理

## 故障排查速查

### 找不到文件？
1. 使用绝对路径测试
2. 检查 path-aliases.json 中的别名映射
3. 确认文件确实存在

### 文件被跳过？
1. 检查文件格式是否在 SupportedMediaFormats 白名单中
2. 查看目标文件夹是否有 .overbase64ignore 文件
3. 开启 DebugMode 查看详细日志

### 没有使用缓存？
1. 确认添加了 `::cache`
2. 检查文件内容是否改变
3. 查看 multimedia_cache.json

### API 调用失败？
1. 检查全局的 API_URL 和 API_Key
2. 确认模型支持多模态（如 gpt-4-vision-preview）
3. 查看服务器日志

## 下一步

- 查看 [README.md](README.md) 了解完整功能
- 查看 [USAGE_EXAMPLES.md](USAGE_EXAMPLES.md) 学习实际应用场景
- 自定义 presets.json 创建专属预设
- 配置 path-aliases.json 简化路径管理

## 技术支持

如遇问题：
1. 开启调试模式（DebugMode=true in config.env）
2. 查看服务器控制台日志
3. 参考 README.md 中的故障排查章节